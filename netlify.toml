[build]
  command = "npm run build"
  publish = ".next"

[functions]
  node_bundler = "esbuild"
  external_node_modules = ["@supabase/functions-js", "@supabase/supabase-js"]
  included_files = [
    "public/**",
    "src/**",
    "next.config.js",
    "package.json",
    "package-lock.json"
  ]
  directory = ".next/server/pages"

[[plugins]]
package = "@netlify/plugin-nextjs"

[build.environment]
  NEXT_PRIVATE_TARGET = "server"
  # Disable Edge Functions as we're using Next.js middleware
  NETLIFY_NEXT_PLUGIN_SKIP = "true"

# Disable Edge Functions as we're using Next.js middleware
[dev]
  framework = "next"